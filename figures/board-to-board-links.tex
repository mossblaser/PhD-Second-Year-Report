\begin{tikzpicture}
	\pgfmathsetlengthmacro{\routeroffset}{4em}
	\pgfmathsetlengthmacro{\routerheight}{2em}
	\pgfmathsetlengthmacro{\fpgagroupoffset}{1.0em}
	\pgfmathsetlengthmacro{\btblabeloffset}{1.5em}
	\pgfmathsetlengthmacro{\fpgalabeloffset}{2.0cm}
	
	\def\boardoffset{4}
	
	% #1 First chip's link
	% #2 Last chip's link
	% #3 Angle of exit from board
	% #4 TikZ Name
	% #5 Link label
	\newcommand{\spinnlink}[5]{
		% Block
		\draw ([shift={(#3:\routeroffset)}]#1) coordinate (#4 p0) -- coordinate (#4 bottom)
		      ([shift={(#3:\routeroffset)}]#2) coordinate (#4 p1) -- coordinate (#4 right)
		      ([shift={(#3:\routeroffset+\routerheight)}]#2) coordinate (#4 p2) -- coordinate (#4 top)
		      ([shift={(#3:\routeroffset+\routerheight)}]#1) coordinate (#4 p3) -- coordinate (#4 left)
		      ([shift={(#3:\routeroffset)}]#1)
		   -- cycle
		      ;
		% Links to chips
		\foreach \link in {0.0,0.14285714,...,1.0}{
			\draw [<->] ($(#1)!\link!(#2)$) -- ++(#3:\routeroffset);
		}
		
		% Links to other boards
		\draw [<->]
		      ([shift={(#3:\routeroffset+\routerheight)}]$(#1)!0.5!(#2)$)
		   -- ++([shift={(#3:-\routeroffset-\routerheight)}]#3:\boardoffset)
		      coordinate (link label);
		
		\node [font=\footnotesize] at ([shift={(#3:\btblabeloffset)}]link label) {#5};
	}
	
	\begin{scope}[scale=0.5]
		\foreach \tbyoff in {0,...,0}{
			\foreach \tbxoff in {0,...,0}{
				\foreach \xoff/\yoff/\colour in {%
					0                / 0                /red%,%
					%4+\boardoffset   / 8+\boardoffset*2 /green,%
					%8+\boardoffset*2 / 4+\boardoffset   /blue%
				}{
					% Chips
					\foreach \x/\y/\num in {%
					                                          0/4/45,   1/4/46,   2/4/47,   3/4/48, %
					                                -1/3/44,  0/3/25,   1/3/26,   2/3/27,   3/3/28, %
					                      -2/2/43,  -1/2/24,  0/2/11,   1/2/12,   2/2/13,   3/2/29, %
					            -3/1/42,  -2/1/23,  -1/1/10,  0/1/3,    1/1/4,    2/1/14,   3/1/30, %
					  -4/0/41,  -3/0/22,  -2/0/9,   -1/0/2,   0/0/1,    1/0/5,    2/0/15,   3/0/31, %
					  -4/-1/40, -3/-1/21, -2/-1/8,  -1/-1/7,  0/-1/6,   1/-1/16,  2/-1/32,          %
					  -4/-2/39, -3/-2/20, -2/-2/19, -1/-2/18, 0/-2/17,  1/-2/33,                    %
					  -4/-3/38, -3/-3/37, -2/-3/36, -1/-3/35, 0/-3/34,                              %
					}{
						\begin{scope}[hexagonXYZ, thick]
							\node [ inner sep=0
							      , draw
							      , hexagon
							      , minimum size=0.5cm
							      , inner sep=0
							      ]
							      at ( \x+\xoff+\tbxoff*12+\tbxoff*\boardoffset*3
							         , \y+\yoff+\tbyoff*12+\tbyoff*\boardoffset*3)
							      (x\tbxoff y\tbyoff z\colour chip\num)
							      {};
						\end{scope}
					}
					
					% Links
					\spinnlink{x\tbxoff y\tbyoff z\colour chip45.side north}{     x\tbxoff y\tbyoff z\colour chip48.side north east}{90}{x\tbxoff y\tbyoff z\colour fpganorth}{N};
					\spinnlink{x\tbxoff y\tbyoff z\colour chip41.side north}{     x\tbxoff y\tbyoff z\colour chip45.side west}{150}{x\tbxoff y\tbyoff z\colour fpgawest}{W};
					\spinnlink{x\tbxoff y\tbyoff z\colour chip38.side south west}{x\tbxoff y\tbyoff z\colour chip41.side west}{-150}{x\tbxoff y\tbyoff z\colour fpgasouth west}{SW};
					\spinnlink{x\tbxoff y\tbyoff z\colour chip34.side south west}{x\tbxoff y\tbyoff z\colour chip38.side south}{-90}{x\tbxoff y\tbyoff z\colour fpgasouth}{S};
					\spinnlink{x\tbxoff y\tbyoff z\colour chip31.side east}{      x\tbxoff y\tbyoff z\colour chip34.side south}{-30}{x\tbxoff y\tbyoff z\colour fpgaeast}{E};
					\spinnlink{x\tbxoff y\tbyoff z\colour chip48.side east}{      x\tbxoff y\tbyoff z\colour chip31.side north east}{30}{x\tbxoff y\tbyoff z\colour fpganorth east}{NE};
					
					% Draw boxes around links shared by an FPGA
					\foreach \lfpga/\rfpga in {south west /west ,east /south ,north /north east }{
						\draw [thick,rounded corners=0.25*\fpgagroupoffset]
						      % Right FPGA:
						        % Bottom right
						        ($(x\tbxoff y\tbyoff z\colour fpga\rfpga p1)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\rfpga p2)$)
						        % Right bottom
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\rfpga p1)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\rfpga p0)$)
						        % Right top
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\rfpga p2)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\rfpga p3)$)
						        % Top right
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\rfpga p2)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\rfpga p1)$)
						        % Top left
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\rfpga p3)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\rfpga p0)$)
						      % Left FPGA:
						        % Top right
						   --   coordinate (this fpga top midpoint)
						        ($(x\tbxoff y\tbyoff z\colour fpga\lfpga p2)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\lfpga p1)$)
						        % Top left
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\lfpga p3)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\lfpga p0)$)
						        % Left top
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\lfpga p3)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\lfpga p2)$)
						        % Left bottom
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\lfpga p0)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\lfpga p1)$)
						        % Bottom left
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\lfpga p0)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\lfpga p3)$)
						        % Bottom right
						   --   ($(x\tbxoff y\tbyoff z\colour fpga\lfpga p1)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\lfpga p2)$)
						   --   coordinate (this fpga bottom midpoint)
						      % Right FPGA:
						        % Bottom left
						        ($(x\tbxoff y\tbyoff z\colour fpga\rfpga p0)!-\fpgagroupoffset!(x\tbxoff y\tbyoff z\colour fpga\rfpga p3)$)
						        % Bottom right
						   --   cycle
						      ;
						
						\node at ($(this fpga top midpoint)!-\fpgalabeloffset!(this fpga bottom midpoint)$)
						      {FPGA X};
					}
				}
			}
		}
	\end{scope}
	
	
\end{tikzpicture}	
